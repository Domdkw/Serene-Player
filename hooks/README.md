# useQueryParams Hook

URL 查询参数处理 Hook，用于在应用启动时解析和处理 URL 参数。

## 支持的参数

| 参数 | 类型 | 说明 |
|------|------|------|
| `netease_music_id` | `string` | 网易云音乐歌曲 ID，自动获取歌曲信息并播放 |
| `open_player` | `boolean` | 打开音乐播放界面 (`true`/`1`) |
| `auto_play` | `boolean` | 自动播放 (`true`/`1`) |
| `playlist_origin` | `string` | 播放列表来源 URL |
| `clear_params` | `boolean` | 处理完成后是否清除 URL 参数 (`true`/`1`) |
| `seek_to` | `number` | 歌曲空降时间点，支持秒数(60)或时间格式(1:30, 1:30:45) |
| `track_index` | `number` | 歌曲在播放列表中的索引位置（从0开始） |

## 使用示例

### URL 示例

```bash
# 播放网易云音乐歌曲
https://your-site.com/?netease_music_id=123456

# 播放网易云音乐歌曲并自动打开播放器
https://your-site.com/?netease_music_id=123456&open_player=true

# 播放本地音乐
https://your-site.com/?local_music=./music/song.mp3

# 加载自定义播放列表
https://your-site.com/?playlist_origin=./customList.json

# 处理完成后清除 URL 参数
https://your-site.com/?netease_music_id=123456&clear_params=true

# 播放网易云音乐歌曲并跳转到指定时间点
https://your-site.com/?netease_music_id=123456&seek_to=60

# 播放播放列表中的指定歌曲并跳转到指定时间
https://your-site.com/?track_index=5&seek_to=1:30

# 组合使用
https://your-site.com/?netease_music_id=123456&auto_play=true&open_player=true&clear_params=1
```

## 处理流程

```
┌─────────────────────────────────────────────────────────────┐
│                      应用启动                                │
└─────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────┐
│              useQueryParams Hook 初始化                      │
│           解析 URL 参数并存储到 pendingParamsRef              │
└─────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────┐
│                    参数类型判断                              │
└─────────────────────────────────────────────────────────────┘
                              │
          ┌───────────────────┼───────────────────┐
          │                   │                   │
          ▼                   ▼                   ▼
┌─────────────────┐ ┌─────────────────┐ ┌─────────────────┐
│ netease_music_id│ │   local_music   │ │ playlist_origin │
│   立即处理       │ │  需要播放列表    │ │   先加载列表     │
└─────────────────┘ └─────────────────┘ └─────────────────┘
          │                   │                   │
          │                   ▼                   │
          │         ┌─────────────────┐           │
          │         │  播放列表为空？  │           │
          │         └─────────────────┘           │
          │              │       │                │
          │         是   │       │ 否             │
          │              ▼       ▼                │
          │    ┌────────────┐ ┌────────────┐      │
          │    │ 等待列表加载│ │  立即匹配   │      │
          │    └────────────┘ └────────────┘      │
          │                   │                   │
          └───────────────────┼───────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────┐
│              clear_params=true ?                            │
│           是：清除 URL 参数                                  │
│           否：保留 URL 参数（默认）                           │
└─────────────────────────────────────────────────────────────┘
```

## 注意事项

1. **网易云音乐 ID** 会立即处理，不需要等待播放列表加载
2. **本地音乐** 需要播放列表加载完成后才能匹配，如果列表为空会等待
3. **默认不清除 URL 参数**，方便用户刷新页面重新触发或分享链接
4. 如果需要处理完成后清除参数，请添加 `clear_params=true`
5. **seek_to 参数** 支持多种时间格式：
   - 纯秒数：60, 90.5
   - 分:秒格式：1:30, 2:45
   - 时:分:秒格式：1:30:45
6. **onSeekTo 处理函数** 必须实现才能使用空降功能，否则时间参数会被忽略
